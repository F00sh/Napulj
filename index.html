<!doctype html>
<html lang="hr" data-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>GONZO NAPULJ ZA NINU ‚Äî Magazin + interaktivna karta</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;800&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="anonymous">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin="anonymous"></script>

  <style>
    :root{
      /* LIGHT */
      --paper:#faf7ef;
      --ink:#1f1e1c;
      --muted:#676056;
      --rule:#d9cfbe;
      --accent:#a14232;
      --safe:#0f6d3d;
      --danger:#9a1e1e;
      --event:#5a48d6;
      --chip:#f1e9d7;
      --panel:#fffef9;
      --card:#fff;
      --shadow:0 8px 24px rgba(0,0,0,.06);
      --nav-h:56px;
    }
    [data-theme="dark"]{
      /* DARK */
      --paper:#141311;
      --ink:#f6f2ea;
      --muted:#b9b1a6;
      --rule:#3d382f;
      --accent:#d86a59;
      --chip:#1d1b18;
      --panel:#191815;
      --card:#151410;
      --shadow:0 8px 24px rgba(0,0,0,.45);
    }

    html,body{height:100%; background:var(--paper); color:var(--ink); scroll-behavior:smooth;}
    body{
      margin:0;
      padding-top:var(--nav-h);
      font: 17px/1.65 Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      -webkit-font-smoothing: antialiased; text-rendering: optimizeLegibility;
    }

    /* ---------- NAVBAR (auto-hide + hamburger) ---------- */
    .topbar{
      position:fixed; inset:0 0 auto 0; height:var(--nav-h); z-index:9999;
      display:flex; align-items:center; gap:14px; padding:8px 14px;
      background:var(--panel); border-bottom:1px solid var(--rule); transition:transform .25s ease, background .2s ease;
    }
    .topbar.hide{ transform: translateY(-110%); }
    .brand{ font:800 15px/1 Inter, sans-serif; letter-spacing:.4px; text-decoration:none; color:var(--ink); padding:6px 10px; border:1px solid var(--rule); border-radius:999px; background:var(--card); }
    .links{ display:flex; gap:10px; overflow:auto; white-space:nowrap; scrollbar-width:none; }
    .links::-webkit-scrollbar{ display:none; }
    .links a{ color:var(--ink); text-decoration:none; padding:6px 10px; border-radius:999px; border:1px solid transparent; }
    .links a:hover{ border-color:var(--rule); background:var(--card); }

    .theme-seg{
      margin-left:auto; display:inline-flex; border:1px solid var(--rule); border-radius:999px; overflow:hidden; background:var(--panel);
    }
    .theme-seg button{ border:0; padding:6px 10px; background:transparent; color:var(--ink); cursor:pointer; font:600 13px/1 Inter, sans-serif; }
    .theme-seg button.active{ background:var(--card); }

    .nav-btn{
      border:1px solid var(--rule); background:var(--card); color:var(--ink);
      padding:6px 10px; border-radius:10px; margin-left:8px; display:none; cursor:pointer;
      font:700 16px/1 Inter, sans-serif;
    }
    .dropdown{
      position:fixed; top:var(--nav-h); left:0; right:0; z-index:9998;
      background:var(--panel); border-bottom:1px solid var(--rule); display:none;
    }
    .dropdown.open{ display:block; }
    .dropdown .menu{ display:flex; flex-direction:column; gap:6px; padding:10px 14px; }
    .dropdown a{ color:var(--ink); text-decoration:none; padding:8px 10px; border-radius:8px; }
    .dropdown a:hover{ background:var(--card); }

    /* Responsive */
    @media (max-width: 860px){
      .links{ display:none; }
      .nav-btn{ display:inline-block; }
    }

    /* ---------- LAYOUT ---------- */
    .wrap{
      display:grid; grid-template-columns: minmax(0,1fr) minmax(340px,520px);
      gap:2.2rem; max-width:1320px; padding:28px 20px; margin:0 auto;
    }
    header{
      grid-column:1/-1; text-align:center; margin-bottom:8px;
      border-bottom: 3px double var(--rule); padding-bottom:16px; position:relative;
    }
    .masthead{ font-family:"Playfair Display", serif; font-weight:800; letter-spacing:.5px; font-size: clamp(30px,4.2vw,52px); }
    .dek{ color:var(--muted); font-style:italic; margin-top:6px; max-width:72ch; margin-inline:auto; }

    .article{ column-count: 2; column-gap: 2.4rem; }
    @media (max-width: 980px){ .wrap{grid-template-columns:1fr;} .article{column-count:1;} }

    h2,h3{
      break-inside: avoid; line-height:1.2; margin: 1.6rem 0 .6rem;
      font-family:"Playfair Display", serif; font-weight:800; scroll-margin-top: calc(var(--nav-h) + 10px);
    }
    h2{ font-size: 28px; border-top:1px solid var(--rule); border-bottom:1px solid var(--rule); padding:.35rem 0; }
    h3{ font-size: 22px; }
    p{ margin:.65rem 0; }
    .lead:first-letter{
      float:left; font-family:"Playfair Display", serif; font-size:3.3rem; line-height:.85;
      padding:.2rem .5rem .2rem 0; font-weight:800; color:var(--accent);
    }
    .kicker{
      display:inline-flex; gap:.6rem; align-items:center;
      font-variant:all-small-caps; letter-spacing:1px; font-weight:800;
      border:1px solid var(--rule); padding:.25rem .6rem; margin:.25rem 0 .75rem;
      color:var(--accent); background:var(--card);
    }
    .rule{ border-top:1px solid var(--rule); margin: 1.1rem 0; }

    .note{ background: var(--panel); border:1px solid var(--rule); padding:.8rem 1rem; color:var(--ink); opacity:.95; box-shadow:0 1px 0 rgba(0,0,0,.04); break-inside: avoid; }
    .pull{
      font-family:"Playfair Display",serif; font-size:22px; line-height:1.35; font-weight:600;
      padding:.8rem 1rem; background:var(--card); border-left:4px solid var(--accent); color:var(--ink);
      margin:1rem 0; break-inside: avoid;
    }

    aside{ position:sticky; top:calc(var(--nav-h) + 10px); align-self:start; display:flex; flex-direction:column; gap:16px; }
    .panel{ border:1px solid var(--rule); background:var(--panel); padding:1rem; box-shadow: var(--shadow); border-radius:10px; }
    #map{
      height: 440px; border:1px solid var(--rule);
      background:var(--card); box-shadow: var(--shadow);
      border-radius:10px; overflow:hidden;
    }

    .filters{ display:flex; flex-wrap:wrap; gap:.5rem; }
    .chip{
      display:inline-flex; align-items:center; gap:.4rem; padding:.35rem .6rem;
      border:1px solid var(--rule); background:var(--chip); border-radius:999px; font-size:.92rem;
      cursor:pointer; user-select:none;
    }
    .chip input{ accent-color:var(--accent); }

    .legend .key{ display:flex; align-items:center; gap:.5rem; margin:.1rem 0;}
    .dot{ width:12px; height:12px; border-radius:50%; display:inline-block; }
    .dot.danger{ background:var(--danger); } .dot.safe{ background:var(--safe); } .dot.event{ background:var(--event); }

    .gallery{ margin-top:18px; display:grid; grid-template-columns: repeat(2,1fr); gap:14px; }
    @media (max-width:680px){ .gallery{ grid-template-columns:1fr; } }
    figure{ margin:0; border:1px solid var(--rule); background:var(--card); break-inside: avoid; box-shadow:0 1px 0 rgba(0,0,0,.04); border-radius:8px; overflow:hidden; }
    figure img{ width:100%; height:auto; display:block; filter: grayscale(100%) contrast(1.05) saturate(.75); transition:filter .2s ease; }
    figure:hover img{ filter: grayscale(0%) contrast(1.05) saturate(1); }
    [data-theme="dark"] figure img{ filter: grayscale(100%) contrast(1.05) saturate(.7) brightness(.9); }

    .timeline{ list-style:none; margin:0; padding:0; display:grid; gap:.8rem; }
    .timeline li{ padding:.6rem .75rem; border:1px dashed var(--rule); background:var(--card); border-radius:8px; }

    footer{
      margin:28px auto 40px; max-width:1320px; padding:0 20px; color:var(--muted);
      border-top: 3px double var(--rule); padding-top:14px; font-size:.95rem;
    }
  </style>
</head>
<body>
  <!-- NAVBAR -->
  <nav id="topbar" class="topbar">
    <a class="brand" href="#top">Napulj za Ninu</a>

    <div class="links" aria-label="Navigacija">
      <a href="#manifest">Manifest</a>
      <a href="#kvartovi">Kvartovi</a>
      <a href="#casefiles">Case files</a>
      <a href="#itinerari">Itinerari</a>
      <a href="#galerija">Galerija</a>
      <a href="#karta">Karta</a>
    </div>

    <div class="theme-seg" role="group" aria-label="Tema">
      <button class="seg" data-mode="light" aria-pressed="false">‚òÄÔ∏é</button>
      <button class="seg" data-mode="auto"  aria-pressed="true">Auto</button>
      <button class="seg" data-mode="dark"  aria-pressed="false">üåô</button>
    </div>

    <button id="navToggle" class="nav-btn" aria-expanded="false" aria-controls="dropdown">‚ò∞</button>
  </nav>

  <!-- MOBILE DROPDOWN -->
  <div id="dropdown" class="dropdown" hidden>
    <div class="menu">
      <a href="#manifest">Manifest</a>
      <a href="#kvartovi">Kvartovi</a>
      <a href="#casefiles">Case files</a>
      <a href="#itinerari">Itinerari</a>
      <a href="#galerija">Galerija</a>
      <a href="#karta">Karta</a>
    </div>
  </div>

  <a id="top"></a>
  <div class="wrap">
    <header>
      <div class="masthead">GONZO NAPULJ ZA NINU</div>
      <div class="dek">Sutra sti≈æe≈°. Ovo je tvoj kratki, drski, ali korisni kompas: gdje ≈°etati, gdje usporiti, kako se nasmijati ‚Äî i kako se vratiti s priƒçom, a ne s prijavom ≈°tete.</div>
    </header>

    <!-- ===================== Lijevi stupci: TEKST ===================== -->
    <main class="article">
      <p class="kicker">satira s ugraƒëenim airbagom</p>
      <p class="lead"><strong>Nina, ovo je tvoj itinerar razuma.</strong> Ne lovi dramu, prepoznaj je i zaobiƒëi. Espresso je saveznik; vespa nije. Vrati se s oba d≈æepa.</p>

      <h2 id="manifest">Manifest pre≈æivljavanja (za tebe)</h2>
      <p><strong>Tvoje tijelo, tvoja granica.</strong> <em>Basta</em> je cijela reƒçenica. Nakit minimalno; <strong>crossbody</strong> sprijeda, zatvaraƒç gore; telefon ne dr≈æi uz rub kolnika. Bar/hotel = ambasada sigurnosti. U gu≈ævi: torba naprijed, ruke preko patenta. Karte ƒçitaj u izlogu.</p>
      <p><strong>Red flag bingo:</strong> ‚Äúbesplatne‚Äù narukvice/ru≈æe; djeƒçje peticije; trio pita‚Äìgura‚Äìbere; skuter duet koji uspori uz tebe. Odgovor: tanak osmijeh, <em>No, grazie</em>, korak dublje na nogostup i u prvi lokal.</p>
      <div class="note"><strong>Set-up za sutra:</strong> powerbank; rezervna kartica + gotovina skriveno; adresa smje≈°taja na papiriƒáu; kopije dokumenata digitalno; la≈æni novƒçanik (10‚Äì20 ‚Ç¨ + stare kartice); kosa u rep/kapuljaƒça; 112 na brzom biranju.</div>

      <h2 id="kvartovi">Kartografski horoskop (kvartovi & reputacije)</h2>
      <h3>Zone ‚Äúdr≈æi oƒçi otvorene‚Äù</h3>
      <p><strong>Quartieri Spagnoli</strong> (≈°arm/usko; noƒáu glavne crte), <strong>Forcella / Via Duomo</strong> (gu≈°ƒáe; kompaktna torba), <strong>Rione Sanit√†</strong> (rani stol), <strong>Piazza Garibaldi / Centrale</strong> (pickpocket HQ), <strong>Spaccanapoli</strong> (≈°etnja da, mobitel nije fenjer). <strong>Scampia</strong> & <strong>Secondigliano</strong> ‚Äî periferije s te≈°kom reputacijom; bez lokalca/razloga: ne.</p>
      <h3>Antidot ‚Äî ljepota bez drame</h3>
      <p><strong>Lungomare</strong>, <strong>Castel dell‚ÄôOvo</strong>, <strong>Vomero</strong>, <strong>Pignasecca</strong> (danju), <strong>Piazza Bellini</strong> (ranije naveƒçer), <strong>Chiaia</strong>, <strong>Murales Maradona</strong> (danju).</p>

      <div class="pull">‚ÄúBar je crkva, telefon nije fenjer. Humor je ≈°tit, granice su zid.‚Äù</div>

      <h2 id="casefiles">Case files</h2>
      <ul class="timeline">
        <li><strong>Faida di Scampia (2000-e)</strong> ‚Äî obraƒçuni oko ‚ÄúVele di Scampia‚Äù. Danas u transformaciji; reputacija ostala. <small>Orijentir: Scampia (sjever).</small></li>
        <li><strong>Forcella ‚Äî tragiƒçan sluƒçaj (2004)</strong> ‚Äî medijski zabilje≈æena smrt djevojke tijekom obraƒçuna. <small>Oko Via Forcella / Via Duomo.</small></li>
        <li><strong>Secondigliano</strong> ‚Äî povijesno upori≈°te klanova; ƒçeste policijske akcije. <small>Uz Scampiju, sjever.</small></li>
      </ul>
      <p class="note">Orijentiri javne reputacije, ne pozivnice. Svrha: znati ‚Üí izbjegavati nepotreban rizik.</p>

      <h2 id="itinerari">Itinerar (za sutra + 3 dana)</h2>
      <h3>Dan 1</h3>
      <p><strong>Pignasecca</strong> (jutro): sitni≈° pri ruci. <strong>Spaccanapoli</strong> (podne): barovi su pit-stop. <strong>Lungomare</strong> (veƒçer): sladoled + vjetar; povratak taksijem/prometnom rutom.</p>
      <h3>Dan 2</h3>
      <p><strong>Vomero</strong> (kava + pogled). <strong>Forcella/centar</strong> (popodne): telefon iznad torbe. <strong>Sanit√†</strong> (rani stol): rezervacija; taksi natrag.</p>
      <h3>Dan 3</h3>
      <p>Tr≈ænice/peƒánice/tave. <strong>Galleria Umberto I</strong> i <strong>Piazza del Plebiscito</strong> za monumentalno bez drame.</p>
      <h3>Dan 4</h3>
      <p><strong>Castel dell‚ÄôOvo</strong> ujutro. Suvenir: priƒça o najhrskavijoj pizzi.</p>

      <div class="rule"></div>

      <h2 id="galerija">Galerija (ulice & prizori)</h2>
      <div class="gallery">
        <figure>
          <img loading="lazy" referrerpolicy="no-referrer" crossorigin="anonymous"
               src="https://upload.wikimedia.org/wikipedia/commons/9/90/Napoli%2C_Murales_Maradona_in_quartiere_Spagnoli_02.jpg"
               data-fallback="https://commons.wikimedia.org/wiki/Special:FilePath/Napoli%2C%20Murales%20Maradona%20in%20quartiere%20Spagnoli%2002.jpg"
               alt="Murales Maradona ‚Äî Quartieri Spagnoli">
          <figcaption>Murales Maradona ‚Äî ikona grada (danju!).</figcaption>
        </figure>

        <figure>
          <img loading="lazy" referrerpolicy="no-referrer" crossorigin="anonymous"
               src="https://upload.wikimedia.org/wikipedia/commons/4/4d/Napoli%2C_Galleria_Umberto_I.jpg"
               data-fallback="https://commons.wikimedia.org/wiki/Special:FilePath/Napoli%2C%20Galleria%20Umberto%20I.jpg"
               alt="Galleria Umberto I ‚Äî unutra≈°njost">
          <figcaption>Galleria Umberto I ‚Äî kupola, mramor i predah.</figcaption>
        </figure>

        <figure>
          <img loading="lazy" referrerpolicy="no-referrer" crossorigin="anonymous"
               src="https://commons.wikimedia.org/wiki/Special:FilePath/Quartieri%20Spagnoli,%20Naples%2020230622%2009.jpg"
               alt="Quartieri Spagnoli">
          <figcaption>Quartieri Spagnoli ‚Äî uske ulice i ve≈°.</figcaption>
        </figure>

        <figure>
          <img loading="lazy" referrerpolicy="no-referrer" crossorigin="anonymous"
               src="https://commons.wikimedia.org/wiki/Special:FilePath/Napoli%20Centrale%20railway%20station%20in%202018.12.jpg"
               alt="Napoli Centrale">
          <figcaption>Napoli Centrale / Piazza Garibaldi ‚Äî pickpocket HQ.</figcaption>
        </figure>

        <figure>
          <img loading="lazy" referrerpolicy="no-referrer" crossorigin="anonymous"
               src="https://commons.wikimedia.org/wiki/Special:FilePath/Panoramica%20dal%20lungomare%20di%20Napoli%20sul%20golfo.jpg"
               alt="Lungomare">
          <figcaption>Lungomare Caracciolo ‚Äî ≈°etnica i more kao sedativ.</figcaption>
        </figure>

        <figure>
          <img loading="lazy" referrerpolicy="no-referrer" crossorigin="anonymous"
               src="https://commons.wikimedia.org/wiki/Special:FilePath/Castel%20dell-Ovo.JPG"
               alt="Castel dell‚ÄôOvo">
          <figcaption>Castel dell‚ÄôOvo ‚Äî fotogeniƒçna tvrƒëava.</figcaption>
        </figure>

        <figure>
          <img loading="lazy" referrerpolicy="no-referrer" crossorigin="anonymous"
               src="https://commons.wikimedia.org/wiki/Special:FilePath/View%20of%20the%20Gulf%20of%20Naples%20from%20the%20Hill%20of%20Vomero.jpg"
               alt="Vomero pogled">
          <figcaption>Vomero ‚Äî kava + panorame.</figcaption>
        </figure>

        <figure>
          <img loading="lazy" referrerpolicy="no-referrer" crossorigin="anonymous"
               src="https://commons.wikimedia.org/wiki/Special:FilePath/Napoli%20mercato%20Pignasecca.jpg"
               alt="Pignasecca">
          <figcaption>Pignasecca ‚Äî street-food (danju).</figcaption>
        </figure>
      </div>
    </main>

    <!-- ===================== Desni stupac: KARTA + PANELI ===================== -->
    <aside id="karta">
      <div class="panel">
        <div class="filters" aria-label="Filtri slojeva">
          <label class="chip"><input type="checkbox" id="fDanger" checked> üî¥ Oprezne zone</label>
          <label class="chip"><input type="checkbox" id="fSafe" checked> üü¢ Opu≈°tenije</label>
          <label class="chip"><input type="checkbox" id="fEvent" checked> üü£ Dogaƒëaji/‚Äúcase files‚Äù</label>
        </div>
      </div>

      <div id="map" aria-label="Karta Napulja s oznaƒçenim zonama i dogaƒëajima">Uƒçitavam kartu‚Ä¶</div>

      <div class="panel legend">
        <div class="key"><span class="dot danger"></span> Zone poveƒáanog opreza</div>
        <div class="key"><span class="dot safe"></span> ‚ÄúSigurnije/opu≈°tenije‚Äù zone</div>
        <div class="key"><span class="dot event"></span> Povijesni dogaƒëaji / medijski sluƒçajevi</div>
        <p style="margin:.6rem 0 0;color:var(--muted);">Orijentacijska karta reputacija i javno poznatih sluƒçajeva. Cilj: informiranost, ne senzacija.</p>
      </div>
    </aside>
  </div>

  <footer>
    Fotografije: Wikimedia Commons. Karta: OpenStreetMap + Leaflet (&copy; CARTO za dark tiles).
  </footer>

  <script>
    (function(){
      // ---------- THEME (Light/Dark/Auto) ----------
      const root = document.documentElement;
      const segBtns = Array.from(document.querySelectorAll('.theme-seg button'));
      const mediaDark = window.matchMedia('(prefers-color-scheme: dark)');

      function effectiveMode(mode){ return mode==='auto' ? (mediaDark.matches ? 'dark':'light') : mode; }
      function applyTheme(mode){
        const eff = effectiveMode(mode);
        root.setAttribute('data-theme', eff);
        localStorage.setItem('themeMode', mode);
        segBtns.forEach(b=>b.classList.toggle('active', b.dataset.mode===mode));
        if (window._map && window._lightTiles && window._darkTiles){
          if (eff==='dark'){ window._map.removeLayer(window._lightTiles); window._darkTiles.addTo(window._map); }
          else { window._map.removeLayer(window._darkTiles); window._lightTiles.addTo(window._map); }
        }
      }
      const saved = localStorage.getItem('themeMode') || 'auto';
      applyTheme(saved);
      mediaDark.addEventListener('change', ()=> { if ((localStorage.getItem('themeMode')||'auto')==='auto') applyTheme('auto'); });
      segBtns.forEach(b=> b.addEventListener('click', ()=> applyTheme(b.dataset.mode)));

      // ---------- NAVBAR auto-hide & dropdown ----------
      const bar = document.getElementById('topbar');
      let lastY = window.scrollY;
      window.addEventListener('scroll', ()=>{
        const y = window.scrollY;
        if (y > lastY && y > 60) bar.classList.add('hide'); else bar.classList.remove('hide');
        lastY = y;
      });

      const navToggle = document.getElementById('navToggle');
      const dropdown = document.getElementById('dropdown');
      function closeMenu(){ dropdown.classList.remove('open'); dropdown.hidden = true; navToggle.setAttribute('aria-expanded','false'); }
      function openMenu(){ dropdown.classList.add('open'); dropdown.hidden = false; navToggle.setAttribute('aria-expanded','true'); }
      navToggle.addEventListener('click', ()=>{
        const open = dropdown.classList.contains('open');
        open ? closeMenu() : openMenu();
      });
      dropdown.querySelectorAll('a').forEach(a=> a.addEventListener('click', closeMenu));
      document.addEventListener('click', (e)=>{
        if (!dropdown.contains(e.target) && !navToggle.contains(e.target)) closeMenu();
      });

      // ---------- Gallery fallback (images) ----------
      document.querySelectorAll('img[data-fallback]').forEach(img=>{
        img.addEventListener('error', ()=>{
          const f = img.getAttribute('data-fallback');
          if (!img.dataset.tried){ img.dataset.tried = '1'; img.src = f; }
        });
      });

      // ---------- MAP ----------
      function initMap(){
        if (typeof L === 'undefined'){
          const el = document.getElementById('map');
          if (el) el.textContent = 'Karta nije uƒçitana (CDN blokiran?). Otvori u drugom pregledniku ili spusti blokade.';
          return;
        }
        const mode = effectiveMode(localStorage.getItem('themeMode')||'auto');
        const map = L.map('map', {scrollWheelZoom:true}).setView([40.8518,14.2681], 12.4);

        // Base tiles
        const lightTiles = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom:19, attribution:'&copy; OpenStreetMap doprinositelji' });
        const darkTiles  = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', { maxZoom:19, attribution:'&copy; OpenStreetMap &copy; CARTO' });
        (mode==='dark' ? darkTiles : lightTiles).addTo(map);
        window._map = map; window._lightTiles = lightTiles; window._darkTiles = darkTiles;

        const danger = [
          { name:'Quartieri Spagnoli', lat:40.8421, lng:14.2450, note:'≈†armantno i usko; noƒáu glavne crte.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Quartieri%20Spagnoli,%20Naples%2020230622%2009.jpg' },
          { name:'Forcella / Via Duomo', lat:40.8508, lng:14.26263, note:'Gusto i ≈æivo; kompaktna torba.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Napoli,%20Duomo%20di%20Napoli.jpg' },
          { name:'Rione Sanit√†', lat:40.8584, lng:14.2445, note:'Idi ranije naveƒçer, rezerviraj.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Rione%20Sanit%C3%A0%201.jpg' },
          { name:'Piazza Garibaldi / Napoli Centrale', lat:40.8515, lng:14.2698, note:'Pickpocket bingo; torba naprijed.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Napoli%20Centrale%20railway%20station%20in%202018.12.jpg' },
          { name:'Spaccanapoli', lat:40.84774, lng:14.25324, note:'≈†etnja da, ‚Äúfenjer od telefona‚Äù ne.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Spaccanapoli%20b%26l.jpg' }
        ];
        const safe = [
          { name:'Lungomare Caracciolo', lat:40.83102, lng:14.22645, note:'≈†etnica + zaljev.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Panoramica%20dal%20lungomare%20di%20Napoli%20sul%20golfo.jpg' },
          { name:"Castel dell'Ovo", lat:40.8279, lng:14.2480, note:'Simbol na moru.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Castel%20dell-Ovo.JPG' },
          { name:'Vomero (pogledi)', lat:40.8333, lng:14.2333, note:'Kava + panorame.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/View%20of%20the%20Gulf%20of%20Naples%20from%20the%20Hill%20of%20Vomero.jpg' },
          { name:'Mercato Pignasecca (danju)', lat:40.84639, lng:14.24781, note:'Street-food; torba naprijed.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Napoli%20mercato%20Pignasecca.jpg' },
          { name:'Piazza Bellini', lat:40.850486, lng:14.251614, note:'≈Ωivo, najljep≈°e ranije naveƒçer.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Piazza%20Bellini%20%28Napoli%29.jpg' },
          { name:'Chiaia', lat:40.83386, lng:14.22697, note:'Butici i barovi.',
            img:'https://upload.wikimedia.org/wikipedia/commons/6/6c/Napoli_-_Via_Chiaia.jpg' },
          { name:'Murales Maradona', lat:40.8434, lng:14.2484, note:'Ikona grada (danju).',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Napoli%2C%20Murales%20Maradona%20in%20quartiere%20Spagnoli%2002.jpg' },
          { name:'Galleria Umberto I', lat:40.8396, lng:14.2496, note:'Kupola i predah.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Napoli%2C%20Galleria%20Umberto%20I.jpg' },
          { name:'Piazza del Plebiscito', lat:40.8358, lng:14.2488, note:'Monumentalno i prostrano.',
            img:'https://upload.wikimedia.org/wikipedia/commons/3/3f/Piazza_del_Plebiscito.jpg' }
        ];
        const events = [
          { name:'Faida di Scampia (2000-e)', lat:40.9013, lng:14.23498,
            note:'Serija obraƒçuna povezanih s Camorrom oko ‚ÄúVele di Scampia‚Äù. Danas u transformaciji; reputacija ostala.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Vele%20di%20Scampia%20Di%20Salvo2.jpg' },
          { name:'Forcella ‚Äî tragiƒçan sluƒçaj (2004)', lat:40.8512, lng:14.2620,
            note:'Medijski zabilje≈æena smrt djevojke tijekom obraƒçuna. Orijentir: Via Forcella/Via Duomo.',
            img:'https://commons.wikimedia.org/wiki/Special:FilePath/Napoli,%20Duomo%20di%20Napoli.jpg' },
          { name:'Secondigliano ‚Äî policijske akcije', lat:40.9000, lng:14.2667,
            note:'Povijesno upori≈°te klanova; ƒçeste racije i uhiƒáenja.',
            img:'https://upload.wikimedia.org/wikipedia/commons/3/35/Napoli%2C_Secondigliano.jpg' }
        ];

        const redStyle   = {radius:8, color:'#9a1e1e', fillColor:'#9a1e1e', fillOpacity:.85};
        const greenStyle = {radius:8, color:'#0f6d3d', fillColor:'#0f6d3d', fillOpacity:.85};
        const eventStyle = {radius:8, color:'#5a48d6', fillColor:'#5a48d6', fillOpacity:.9};
        const popup = p => `<strong>${p.name}</strong><br/><em>${p.note}</em><br/>${p.img?`<a href="${p.img}" target="_blank" rel="noopener">Vidi fotografiju</a>`:''}`;

        const Ldanger = L.layerGroup(danger.map(p=>L.circleMarker([p.lat,p.lng], redStyle).bindPopup(popup(p))));
        const Lsafe   = L.layerGroup(safe.map(p=>L.circleMarker([p.lat,p.lng], greenStyle).bindPopup(popup(p))));
        const Levent  = L.layerGroup(events.map(p=>L.circleMarker([p.lat,p.lng], eventStyle).bindPopup(popup(p))));

        Ldanger.addTo(map); Lsafe.addTo(map); Levent.addTo(map);

        document.getElementById('fDanger').addEventListener('change', e=> e.target.checked ? Ldanger.addTo(map) : map.removeLayer(Ldanger));
        document.getElementById('fSafe').addEventListener('change',   e=> e.target.checked ? Lsafe.addTo(map)   : map.removeLayer(Lsafe));
        document.getElementById('fEvent').addEventListener('change',  e=> e.target.checked ? Levent.addTo(map)  : map.removeLayer(Levent));
      }

      if (document.readyState !== 'loading') initMap();
      else document.addEventListener('DOMContentLoaded', initMap);
    })();
  </script>
</body>
</html>